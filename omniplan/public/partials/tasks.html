<div ng-hide="isLoggedIn()">
  <h3>Please <a href="/#/login">Log In</a> or <a href="/#/register">Register</a> to access the tasks.</h3>
</div>

<div ng-show="isLoggedIn()">
  <div class="page-header">
    <h1>Next tasks</h1>
  </div>

  <ul class="list-group">
    <li ng-repeat="task in tasks" class="list-group-item taskline" ng-mouseenter="currentTask=$index" ng-mouseleave="currentTask=-1; addTagIndex=-1">
      
      <div class="row">
        <div class="col-md-10">
          <h4 class=>{{task.title}}</h4>
          <ul class="list-inline">
            <li ng-repeat="tag in task.tags | orderBy:'+name'">
              <span class="btn btn-xs" ng-style="{ backgroundColor: '{{tag.bgColor}}', color: '{{tag.fgColor}}' }"
                ng-click="removeTag(task,tag.name);">
                {{tag.name}} <i class="fa fa-times fa-fw fa-inverse"></i></span>
            </li>
            <li>
              <div class="btn btn-success btn-xs" ng-show="currentTask==$index && addTagIndex!=$index" ng-click="addTagIndex = $index">
                <i class="fa fa-plus fa-fw fa-inverse"></i></div>
              <div ng-show="addTagIndex==$index">
                <div class="input-group input-group-sm" style="width:200px;">
                  <span class="input-group-addon" id="tag-addon">#</span>
                  <input type="text" class="form-control" placeholder="Tag name" aria-describedby="tag-addon"
                    ng-model="tagName" ng-enter="addTagIndex=-1; addTag(task,tagName);">
                </div>
              </div>
            </li>
          </ul>
          <div>{{task.user}}{{task.description=="" ? " - No description" : " - "+task.description}}</div>
        </div>
        <div class="col-md-1">
          <i ng-show="isRunning(task)" ng-click="stopTask(task)" class="ibutton fa fa-stop fa-lg ired"></i>
          <i ng-hide="isRunning(task)" ng-click="startTask(task)" class="ibutton fa fa-play fa-lg igreen"></i>            
          <i ng-click="closeTask(task)" class="ibutton igreen fa fa-check fa-lg"></i>            
          <i ng-click="deleteTask(task)" class="ibutton ired fa fa-trash-o fa-lg"></i>
        </div>
        <div class="col-md-1">
          <span class="totalTime">{{task.totalTime | toHMS }}</span>
          <span ng-show="isRunning(task)">Session: {{ (currentTime - task.startTime)/1000.0 | toHMS }}</span>
        </div>
      </div>

    </li>
  </ul>
</div>
